(this["webpackJsonpmarko-2021-03-03"]=this["webpackJsonpmarko-2021-03-03"]||[]).push([[0],{30:function(e,n,t){},36:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r),c=t(21),i=t.n(c),a=(t(28),t(29),t(30),t(2)),s=t(3),u="book_ui_1",d="PI_XBTUSD",b=function(e){return"object"===typeof e&&"number"===typeof e.numLevels&&"string"===typeof e.feed&&e.feed.endsWith("_snapshot")&&"string"===typeof e.product_id&&Array.isArray(e.asks)&&Array.isArray(e.bids)},j=function(e){return"object"===typeof e&&"string"===typeof e.product_id&&Array.isArray(e.asks)&&Array.isArray(e.bids)};function f(e){var n,t=e.onData,r=e.onError,o=e.productIds,c=new WebSocket("wss://www.cryptofacilities.com/ws/v1");return c.addEventListener("open",(function(){n=!1;var e=JSON.stringify(S(o));c.send(e)})),c.addEventListener("error",(function(e){r(e),c.close()})),c.addEventListener("message",(function(e){var r=function(e){try{return JSON.parse(e.data)}catch(n){E(c,n)}}(e);r&&(function(e){return"object"===typeof e&&"subscribed"===e.event}(r)&&((n=L(r,o))||E(c,new Error("OrderBook handshake failed"))),n&&(b(r)||j(r))&&t(r))})),function(){c.close()}}var l,O,v,p,g,x,h,m,y,w,k,S=function(e){return{event:"subscribe",feed:u,product_ids:e}},E=function(e,n){var t=document.createEvent("CustomEvent");t.initCustomEvent("error",!1,!1,n),e.dispatchEvent(t)},L=function(e,n){var t=e.feed===u,r=e.product_ids.every((function(e){return n.includes(e)}));return t&&r},M=t(8),I=t(5),A=t(38),F=t(39),_=t(22),T=t.n(_),C=function(e,n){var t=T()(e,n,(function(e){return Object(I.a)(e,1)[0]}));return e.splice(t,0,n),e},z=function(e,n){return e.splice(n,1),e},B=function(e,n){var t=Object(I.a)(n,2),r=t[0],o=t[1],c=e.findIndex((function(e){return Object(I.a)(e,1)[0]===r})),i=-1===c,a=o>0;if(i&&!a)return e;var s=Object(M.a)(e);return i?C(s,n):a?(s[c]=n,s):z(s,c)},D=function(e){var n=Object(r.useState)(!0),t=Object(I.a)(n,2),o=t[0],c=t[1],i=Object(r.useRef)([]),a=Object(r.useRef)([]),s=Object(r.useState)(),u=Object(I.a)(s,2),d=u[0],l=u[1],O=Object(A.a)();return Object(F.a)(O),Object(r.useEffect)((function(){return f({onData:function(e){b(e)&&(c(!1),i.current=e.asks,a.current=e.bids),j(e)&&(i.current=e.asks.reduce((function(e,n){return B(e,n)}),i.current),a.current=e.bids.reduce((function(e,n){return B(e,n)}),a.current))},onError:l,productIds:[e]})}),[e]),{asks:i.current,bids:Object(M.a)(a.current).reverse(),error:d,isLoading:o}},H=t(23),J=Object(H.a)({},d,"XBT/USD"),P=function(e){return J[e]},X=s.a.div(l||(l=Object(a.a)(["\n  display: flex;\n  flex-direction: column;\n  font-family: var(--font-mono);\n  font-size: var(--card-font-size);\n  background: var(--card-bg);\n  color: var(--card-color);\n  padding: 16px 0;\n"]))),N=s.a.div(O||(O=Object(a.a)(["\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  grid-auto-rows: 20px;\n  column-gap: var(--grid-column-gap);\n  row-gap: 4px;\n  text-align: right;\n"]))),R=function(e,n){if(!n)return 0;var t=Object(I.a)(n,1)[0],r=e.findIndex((function(e){return e[0]===t}));return-1===r?0:e.slice(0,r+1).reduce((function(e,n){return e+Object(I.a)(n,2)[1]}),0)},U=t(13),W=s.a.div(v||(v=Object(a.a)(["\n  padding: 4px 8px;\n  min-width: 90px;\n"]))),q=Object(s.a)(W)(p||(p=Object(a.a)(["\n  position: relative;\n\n  &:hover {\n    font-weight: bold;\n  }\n\n  &:nth-of-type(3n + 1) {\n    --row-full-width: calc(300% + var(--grid-column-gap) * 2);\n    color: var(--text-color);\n\n    ","\n\n    &:before {\n      content: '';\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      width: var(--row-full-width);\n      background: var(--row-background);\n      transform-origin: 0;\n      transform: scaleX(var(--percent));\n    }\n  }\n"])),(function(e){return e.isHovered&&G})),G=Object(U.a)(g||(g=Object(a.a)(["\n  &:after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    width: var(--row-full-width);\n    background: rgba(255, 255, 255, 0.1);\n  }\n"]))),K=q,Q=t(1),V=function(e){var n=e.isHovered,t=e.onMouseOut,r=e.onMouseOver,o=e.price,c=e.size,i=e.total,a=e.totalSum;return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(K,{isHovered:n,onMouseOut:t,onMouseOver:r,style:{"--percent":(i-c)/a},children:o.toLocaleString()}),Object(Q.jsx)(K,{onMouseOut:t,onMouseOver:r,children:c.toLocaleString()}),Object(Q.jsx)(K,{onMouseOut:t,onMouseOver:r,children:i.toLocaleString()})]})},Y=function(e){var n=e.orders,t=e.reversedTotal,o=void 0!==t&&t,c=Object(r.useState)(-1),i=Object(I.a)(c,2),a=i[0],s=i[1],u=o?Object(M.a)(n).reverse():n,d=R(n,n[n.length-1]);return Object(Q.jsx)(Q.Fragment,{children:n.map((function(e,n){var t=Object(I.a)(e,2),r=t[0],o=t[1];return Object(Q.jsx)(V,{isHovered:a===n,onMouseOut:function(){return s(-1)},onMouseOver:function(){return s(n)},price:r,size:o,total:R(u,[r,o]),totalSum:d},r)}))})},Z=s.a.span(x||(x=Object(a.a)(["\n  color: var(--card-title-color);\n  text-transform: uppercase;\n  border-bottom: 1px dotted;\n"]))),$=function(){return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(W,{children:Object(Q.jsx)(Z,{children:"Price"})}),Object(Q.jsx)(W,{children:Object(Q.jsx)(Z,{children:"Size"})}),Object(Q.jsx)(W,{children:Object(Q.jsx)(Z,{children:"Total"})})]})},ee=s.a.h2(h||(h=Object(a.a)(["\n  text-align: center;\n  margin: 0 0 16px;\n"]))),ne=Object(s.a)(N)(m||(m=Object(a.a)(["\n  --grid-column-gap: 8px;\n"]))),te=Object(s.a)(ne)(y||(y=Object(a.a)(["\n  margin-bottom: 16px;\n  --text-color: var(--asks-color);\n  --row-background: var(--asks-bg);\n"]))),re=Object(s.a)(ne)(w||(w=Object(a.a)(["\n  --text-color: var(--bids-color);\n  --row-background: var(--bids-bg);\n"]))),oe=function(e){var n=e.ordersCount,t=void 0===n?10:n,o=e.productId,c=D(o),i=c.asks,a=c.bids,s=c.error,u=c.isLoading;return Object(r.useEffect)((function(){s&&console.error(s)}),[s]),Object(Q.jsxs)(X,{children:[Object(Q.jsxs)(ee,{children:["Orderbook (",P(o),")"]}),u&&"Loading...",!u&&Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsxs)(te,{children:[Object(Q.jsx)($,{}),Object(Q.jsx)(Y,{orders:i.slice(0,t),reversedTotal:!0})]}),Object(Q.jsx)(re,{children:Object(Q.jsx)(Y,{orders:a.slice(-t)})})]})]})},ce=s.a.div(k||(k=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 16px 0;\n"]))),ie=function(){return Object(Q.jsx)(ce,{children:Object(Q.jsx)(oe,{productId:d})})},ae=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,40)).then((function(n){var t=n.getCLS,r=n.getFID,o=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),r(e),o(e),c(e),i(e)}))};i.a.render(Object(Q.jsx)(o.a.StrictMode,{children:Object(Q.jsx)(ie,{})}),document.getElementById("root")),ae()}},[[36,1,2]]]);
//# sourceMappingURL=main.953be329.chunk.js.map