(this["webpackJsonpmarko-2021-03-03"]=this["webpackJsonpmarko-2021-03-03"]||[]).push([[0],{32:function(e,n,t){},38:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t.n(r),o=t(23),i=t.n(o),a=(t(30),t(31),t(32),t(2)),s=t(4),u=t(3),d="book_ui_1",b="PI_XBTUSD",j=function(e){return"object"===typeof e&&"number"===typeof e.numLevels&&"string"===typeof e.feed&&e.feed.endsWith("_snapshot")&&"string"===typeof e.product_id&&Array.isArray(e.asks)&&Array.isArray(e.bids)},l=function(e){return"object"===typeof e&&"string"===typeof e.product_id&&Array.isArray(e.asks)&&Array.isArray(e.bids)};function O(e){var n,t=e.onData,r=e.onError,c=e.productIds,o=new WebSocket("wss://www.cryptofacilities.com/ws/v1");return o.addEventListener("open",(function(){n=!1;var e=JSON.stringify(A(c));o.send(e)})),o.addEventListener("error",(function(e){r(e),o.close()})),o.addEventListener("message",(function(e){var r=function(e){if(e.data)try{return JSON.parse(e.data)}catch(n){C(o,n)}}(e);r&&(function(e){return"object"===typeof e&&"subscribed"===e.event}(r)&&((n=L(r,c))||C(o,new Error("OrderBook handshake failed"))),n&&(j(r)||l(r))&&t(r))})),function(){o.close()}}var f,v,p,g,x,h,m,y,k,w,E,S,I,F,M,A=function(e){return{event:"subscribe",feed:d,product_ids:e}},C=function(e,n){var t=document.createEvent("CustomEvent");t.initCustomEvent("error",!1,!1,n),e.dispatchEvent(t)},L=function(e,n){var t=e.feed===d,r=e.product_ids.every((function(e){return n.includes(e)}));return t&&r},_=t(41),D=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=Object(r.useState)(e),t=Object(s.a)(n,2),c=t[0],o=t[1];return Object(_.a)("visibilitychange",Object(r.useCallback)((function(){o(!document.hidden)}),[])),c},T=t(8),z=t(9),B=t(39),H=t(40),J=function(e){return e.sort((function(e,n){return Object(s.a)(e,1)[0]-Object(s.a)(n,1)[0]}))},P=t(24),N=t.n(P),R=function(e,n){var t=N()(e,n,(function(e){return Object(s.a)(e,1)[0]}));return e.splice(t,0,n),e},X=function(e,n){return e.splice(n,1),e},U=function(e,n){var t=Object(s.a)(n,2),r=t[0],c=t[1],o=e.findIndex((function(e){return Object(s.a)(e,1)[0]===r})),i=-1===o,a=c>0;if(i&&!a)return e;var u=Object(z.a)(e);return i?R(u,n):a?(u[o]=n,u):X(u,o)},W=function(e){var n=e.onError,t=e.productId,c=Object(r.useState)(!0),o=Object(s.a)(c,2),i=o[0],a=o[1],u=Object(r.useRef)([]),d=Object(r.useRef)([]),b=Object(B.a)();return Object(H.a)(b),Object(r.useEffect)((function(){return O({onData:function(e){j(e)&&(a(!1),u.current=J(e.asks),d.current=J(e.bids)),l(e)&&(u.current=e.asks.reduce((function(e,n){return U(e,n)}),u.current),d.current=e.bids.reduce((function(e,n){return U(e,n)}),d.current))},onError:n,productIds:[t]})}),[n,t]),{asks:Object(z.a)(u.current).reverse(),bids:Object(z.a)(d.current).reverse(),isLoading:i}},q=t(17),G=Object(q.a)({},b,"XBT/USD"),K=function(e){return G[e]},Q=function(){},V=t.p+"static/media/loader.50179ff6.svg",Y=t(1),Z=function(e){return Object(Y.jsx)("img",Object(T.a)(Object(T.a)({},e),{},{src:V,alt:"Loading..."}))},$=u.a.div(f||(f=Object(a.a)(["\n  display: flex;\n  flex-direction: column;\n  font-family: var(--font-mono);\n  font-size: var(--card-font-size);\n  background: var(--card-bg);\n  color: var(--card-color);\n  padding: 16px 0;\n"]))),ee=u.a.div(v||(v=Object(a.a)(["\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  grid-auto-rows: 20px;\n  column-gap: var(--grid-column-gap);\n  row-gap: 4px;\n  text-align: right;\n"]))),ne=function(e,n){if(!n)return 0;var t=Object(s.a)(n,1)[0],r=e.findIndex((function(e){return e[0]===t}));return-1===r?0:e.slice(0,r+1).reduce((function(e,n){return e+Object(s.a)(n,2)[1]}),0)},te=function(e,n){var t=n.digits;return Intl.NumberFormat(void 0,{maximumFractionDigits:t,minimumFractionDigits:t}).format(e)},re=t(14),ce=u.a.div(p||(p=Object(a.a)(["\n  padding: 4px 8px;\n  min-width: 90px;\n"]))),oe=Object(u.a)(ce)(g||(g=Object(a.a)(["\n  position: relative;\n\n  &:hover {\n    font-weight: bold;\n  }\n\n  &:nth-of-type(3n + 1) {\n    --row-full-width: calc(300% + var(--grid-column-gap) * 2);\n    color: var(--text-color);\n\n    ","\n\n    &:before {\n      content: '';\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      width: var(--row-full-width);\n      background: var(--row-background);\n      transform-origin: 0;\n      transform: scaleX(var(--percent));\n    }\n  }\n"])),(function(e){return e.isHovered&&ie})),ie=Object(re.a)(x||(x=Object(a.a)(["\n  &:after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    width: var(--row-full-width);\n    background: rgba(255, 255, 255, 0.1);\n  }\n"]))),ae=oe,se=function(e){var n=e.index,t=e.isHovered,r=e.onMouseOut,c=e.onMouseOver,o=e.price,i=e.size,a=e.total,s=e.totalSum,u=0===n?a/s:(a-i)/s;return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(ae,{isHovered:t,onMouseOut:r,onMouseOver:c,style:{"--percent":u},children:te(o,{digits:2})}),Object(Y.jsx)(ae,{onMouseOut:r,onMouseOver:c,children:te(i,{digits:0})}),Object(Y.jsx)(ae,{onMouseOut:r,onMouseOver:c,children:te(a,{digits:0})})]})},ue=function(e){var n=e.orders,t=e.reversedTotal,c=void 0!==t&&t,o=Object(r.useState)(-1),i=Object(s.a)(o,2),a=i[0],u=i[1],d=c?Object(z.a)(n).reverse():n,b=ne(n,n[n.length-1]);return Object(Y.jsx)(Y.Fragment,{children:n.map((function(e,n){var t=Object(s.a)(e,2),r=t[0],c=t[1];return Object(Y.jsx)(se,{index:n,isHovered:a===n,onMouseOut:function(){return u(-1)},onMouseOver:function(){return u(n)},price:r,size:c,total:ne(d,[r,c]),totalSum:b},r)}))})},de=u.a.span(h||(h=Object(a.a)(["\n  color: var(--card-title-color);\n  text-transform: uppercase;\n  border-bottom: 1px dotted;\n"]))),be=function(){return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(ce,{children:Object(Y.jsx)(de,{children:"Price"})}),Object(Y.jsx)(ce,{children:Object(Y.jsx)(de,{children:"Size"})}),Object(Y.jsx)(ce,{children:Object(Y.jsx)(de,{children:"Total"})})]})},je=u.a.h2(m||(m=Object(a.a)(["\n  text-align: center;\n  margin: 0 0 16px;\n  padding: 0 16px;\n"]))),le=Object(u.a)(ee)(y||(y=Object(a.a)(["\n  --grid-column-gap: 8px;\n"]))),Oe=Object(u.a)(le)(k||(k=Object(a.a)(["\n  margin-bottom: 16px;\n  --text-color: var(--asks-color);\n  --row-background: var(--asks-bg);\n"]))),fe=Object(u.a)(le)(w||(w=Object(a.a)(["\n  --text-color: var(--bids-color);\n  --row-background: var(--bids-bg);\n"]))),ve=u.a.div(E||(E=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),pe=Object(u.a)(Z)(S||(S=Object(a.a)(["\n  width: 50px;\n  height: 50px;\n"]))),ge=function(e){var n=e.onError,t=e.ordersCount,r=void 0===t?10:t,c=e.productId,o=W({onError:n,productId:c}),i=o.asks,a=o.bids,s=o.isLoading;return Object(Y.jsxs)($,{children:[Object(Y.jsxs)(je,{children:["Orderbook (",K(c),")"]}),s&&Object(Y.jsx)(ve,{children:Object(Y.jsx)(pe,{})}),!s&&Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsxs)(Oe,Object(T.a)(Object(T.a)({},Q("asks-grid")),{},{children:[Object(Y.jsx)(be,{}),Object(Y.jsx)(ue,{orders:i.slice(0,r),reversedTotal:!0})]})),Object(Y.jsx)(fe,Object(T.a)(Object(T.a)({},Q("bids-grid")),{},{children:Object(Y.jsx)(ue,{orders:a.slice(0,r)})}))]})]})},xe=u.a.div(I||(I=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 16px 0;\n"]))),he=u.a.div(F||(F=Object(a.a)(["\n  text-align: center;\n"]))),me=u.a.button(M||(M=Object(a.a)(["\n  cursor: pointer;\n"]))),ye=function(){var e=Object(r.useState)(!1),n=Object(s.a)(e,2),t=n[0],c=n[1],o=D(),i=Object(r.useCallback)((function(e){console.error(e),c(!0)}),[]);return Object(Y.jsxs)(xe,{children:[!t&&o&&Object(Y.jsx)(ge,{onError:i,productId:b}),t&&Object(Y.jsxs)(he,{children:[Object(Y.jsx)("p",{children:"An error occurred"}),Object(Y.jsx)("div",{children:Object(Y.jsx)(me,{onClick:function(){return c(!1)},type:"button",children:"Retry"})})]})]})},ke=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,42)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,o=n.getLCP,i=n.getTTFB;t(e),r(e),c(e),o(e),i(e)}))};i.a.render(Object(Y.jsx)(c.a.StrictMode,{children:Object(Y.jsx)(ye,{})}),document.getElementById("root")),ke()}},[[38,1,2]]]);
//# sourceMappingURL=main.522149cf.chunk.js.map