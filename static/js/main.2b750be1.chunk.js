(this["webpackJsonpmarko-2021-03-03"]=this["webpackJsonpmarko-2021-03-03"]||[]).push([[0],{31:function(n,e,t){},37:function(n,e,t){"use strict";t.r(e);var r=t(0),c=t.n(r),o=t(23),i=t.n(o),a=(t(29),t(30),t(31),t(2)),s=t(5),u=t(3),d="book_ui_1",b="PI_XBTUSD",j=function(n){return"object"===typeof n&&"number"===typeof n.numLevels&&"string"===typeof n.feed&&n.feed.endsWith("_snapshot")&&"string"===typeof n.product_id&&Array.isArray(n.asks)&&Array.isArray(n.bids)},l=function(n){return"object"===typeof n&&"string"===typeof n.product_id&&Array.isArray(n.asks)&&Array.isArray(n.bids)};function f(n){var e,t=n.onData,r=n.onError,c=n.productIds,o=new WebSocket("wss://www.cryptofacilities.com/ws/v1");return o.addEventListener("open",(function(){e=!1;var n=JSON.stringify(A(c));o.send(n)})),o.addEventListener("error",(function(n){r(n),o.close()})),o.addEventListener("message",(function(n){var r=function(n){try{return JSON.parse(n.data)}catch(e){C(o,e)}}(n);r&&(function(n){return"object"===typeof n&&"subscribed"===n.event}(r)&&((e=F(r,c))||C(o,new Error("OrderBook handshake failed"))),e&&(j(r)||l(r))&&t(r))})),function(){o.close()}}var O,p,v,g,x,h,m,y,k,w,E,S,L,I,M,A=function(n){return{event:"subscribe",feed:d,product_ids:n}},C=function(n,e){var t=document.createEvent("CustomEvent");t.initCustomEvent("error",!1,!1,e),n.dispatchEvent(t)},F=function(n,e){var t=n.feed===d,r=n.product_ids.every((function(n){return e.includes(n)}));return t&&r},_=t(8),T=t(39),z=t(40),B=t(24),D=t.n(B),H=function(n,e){var t=D()(n,e,(function(n){return Object(s.a)(n,1)[0]}));return n.splice(t,0,e),n},J=function(n,e){return n.splice(e,1),n},P=function(n,e){var t=Object(s.a)(e,2),r=t[0],c=t[1],o=n.findIndex((function(n){return Object(s.a)(n,1)[0]===r})),i=-1===o,a=c>0;if(i&&!a)return n;var u=Object(_.a)(n);return i?H(u,e):a?(u[o]=e,u):J(u,o)},R=function(n){var e=n.onError,t=n.productId,c=Object(r.useState)(!0),o=Object(s.a)(c,2),i=o[0],a=o[1],u=Object(r.useRef)([]),d=Object(r.useRef)([]),b=Object(T.a)();return Object(z.a)(b),Object(r.useEffect)((function(){return f({onData:function(n){j(n)&&(a(!1),u.current=n.asks,d.current=n.bids),l(n)&&(u.current=n.asks.reduce((function(n,e){return P(n,e)}),u.current),d.current=n.bids.reduce((function(n,e){return P(n,e)}),d.current))},onError:e,productIds:[t]})}),[e,t]),{asks:u.current,bids:Object(_.a)(d.current).reverse(),isLoading:i}},X=t(16),N=Object(X.a)({},b,"XBT/USD"),U=function(n){return N[n]},W=t(21),q=t.p+"static/media/loader.50179ff6.svg",G=t(1),K=function(n){return Object(G.jsx)("img",Object(W.a)(Object(W.a)({},n),{},{src:q,alt:"Loading..."}))},Q=u.a.div(O||(O=Object(a.a)(["\n  display: flex;\n  flex-direction: column;\n  font-family: var(--font-mono);\n  font-size: var(--card-font-size);\n  background: var(--card-bg);\n  color: var(--card-color);\n  padding: 16px 0;\n"]))),V=u.a.div(p||(p=Object(a.a)(["\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  grid-auto-rows: 20px;\n  column-gap: var(--grid-column-gap);\n  row-gap: 4px;\n  text-align: right;\n"]))),Y=function(n,e){if(!e)return 0;var t=Object(s.a)(e,1)[0],r=n.findIndex((function(n){return n[0]===t}));return-1===r?0:n.slice(0,r+1).reduce((function(n,e){return n+Object(s.a)(e,2)[1]}),0)},Z=t(13),$=u.a.div(v||(v=Object(a.a)(["\n  padding: 4px 8px;\n  min-width: 90px;\n"]))),nn=Object(u.a)($)(g||(g=Object(a.a)(["\n  position: relative;\n\n  &:hover {\n    font-weight: bold;\n  }\n\n  &:nth-of-type(3n + 1) {\n    --row-full-width: calc(300% + var(--grid-column-gap) * 2);\n    color: var(--text-color);\n\n    ","\n\n    &:before {\n      content: '';\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      width: var(--row-full-width);\n      background: var(--row-background);\n      transform-origin: 0;\n      transform: scaleX(var(--percent));\n    }\n  }\n"])),(function(n){return n.isHovered&&en})),en=Object(Z.a)(x||(x=Object(a.a)(["\n  &:after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    width: var(--row-full-width);\n    background: rgba(255, 255, 255, 0.1);\n  }\n"]))),tn=nn,rn=function(n){var e=n.isHovered,t=n.onMouseOut,r=n.onMouseOver,c=n.price,o=n.size,i=n.total,a=n.totalSum;return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(tn,{isHovered:e,onMouseOut:t,onMouseOver:r,style:{"--percent":(i-o)/a},children:c.toLocaleString()}),Object(G.jsx)(tn,{onMouseOut:t,onMouseOver:r,children:o.toLocaleString()}),Object(G.jsx)(tn,{onMouseOut:t,onMouseOver:r,children:i.toLocaleString()})]})},cn=function(n){var e=n.orders,t=n.reversedTotal,c=void 0!==t&&t,o=Object(r.useState)(-1),i=Object(s.a)(o,2),a=i[0],u=i[1],d=c?Object(_.a)(e).reverse():e,b=Y(e,e[e.length-1]);return Object(G.jsx)(G.Fragment,{children:e.map((function(n,e){var t=Object(s.a)(n,2),r=t[0],c=t[1];return Object(G.jsx)(rn,{isHovered:a===e,onMouseOut:function(){return u(-1)},onMouseOver:function(){return u(e)},price:r,size:c,total:Y(d,[r,c]),totalSum:b},r)}))})},on=u.a.span(h||(h=Object(a.a)(["\n  color: var(--card-title-color);\n  text-transform: uppercase;\n  border-bottom: 1px dotted;\n"]))),an=function(){return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)($,{children:Object(G.jsx)(on,{children:"Price"})}),Object(G.jsx)($,{children:Object(G.jsx)(on,{children:"Size"})}),Object(G.jsx)($,{children:Object(G.jsx)(on,{children:"Total"})})]})},sn=u.a.h2(m||(m=Object(a.a)(["\n  text-align: center;\n  margin: 0 0 16px;\n  padding: 0 16px;\n"]))),un=Object(u.a)(V)(y||(y=Object(a.a)(["\n  --grid-column-gap: 8px;\n"]))),dn=Object(u.a)(un)(k||(k=Object(a.a)(["\n  margin-bottom: 16px;\n  --text-color: var(--asks-color);\n  --row-background: var(--asks-bg);\n"]))),bn=Object(u.a)(un)(w||(w=Object(a.a)(["\n  --text-color: var(--bids-color);\n  --row-background: var(--bids-bg);\n"]))),jn=u.a.div(E||(E=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),ln=Object(u.a)(K)(S||(S=Object(a.a)(["\n  width: 50px;\n  height: 50px;\n"]))),fn=function(n){var e=n.onError,t=n.ordersCount,r=void 0===t?10:t,c=n.productId,o=R({onError:e,productId:c}),i=o.asks,a=o.bids,s=o.isLoading;return Object(G.jsxs)(Q,{children:[Object(G.jsxs)(sn,{children:["Orderbook (",U(c),")"]}),s&&Object(G.jsx)(jn,{children:Object(G.jsx)(ln,{})}),!s&&Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)(dn,{children:[Object(G.jsx)(an,{}),Object(G.jsx)(cn,{orders:i.slice(0,r),reversedTotal:!0})]}),Object(G.jsx)(bn,{children:Object(G.jsx)(cn,{orders:a.slice(-r)})})]})]})},On=u.a.div(L||(L=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 16px 0;\n"]))),pn=u.a.div(I||(I=Object(a.a)(["\n  text-align: center;\n"]))),vn=u.a.button(M||(M=Object(a.a)(["\n  cursor: pointer;\n"]))),gn=function(){var n=Object(r.useState)(!1),e=Object(s.a)(n,2),t=e[0],c=e[1],o=Object(r.useCallback)((function(n){console.error(n),c(!0)}),[]);return Object(G.jsxs)(On,{children:[!t&&Object(G.jsx)(fn,{onError:o,productId:b}),t&&Object(G.jsxs)(pn,{children:[Object(G.jsx)("p",{children:"An error occurred"}),Object(G.jsx)("div",{children:Object(G.jsx)(vn,{onClick:function(){return c(!1)},type:"button",children:"Retry"})})]})]})},xn=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,41)).then((function(e){var t=e.getCLS,r=e.getFID,c=e.getFCP,o=e.getLCP,i=e.getTTFB;t(n),r(n),c(n),o(n),i(n)}))};i.a.render(Object(G.jsx)(c.a.StrictMode,{children:Object(G.jsx)(gn,{})}),document.getElementById("root")),xn()}},[[37,1,2]]]);
//# sourceMappingURL=main.2b750be1.chunk.js.map