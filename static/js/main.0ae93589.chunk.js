(this["webpackJsonpmarko-2021-03-03"]=this["webpackJsonpmarko-2021-03-03"]||[]).push([[0],{30:function(n,e,t){},36:function(n,e,t){"use strict";t.r(e);var r=t(0),c=t.n(r),o=t(21),i=t.n(o),a=(t(28),t(29),t(30),t(2)),s=t(3),u="book_ui_1",d="PI_XBTUSD",b=function(n){return"object"===typeof n&&"number"===typeof n.numLevels&&"string"===typeof n.feed&&n.feed.endsWith("_snapshot")&&"string"===typeof n.product_id&&Array.isArray(n.asks)&&Array.isArray(n.bids)},j=function(n){return"object"===typeof n&&"string"===typeof n.product_id&&Array.isArray(n.asks)&&Array.isArray(n.bids)};function f(n){var e,t=n.onData,r=n.onError,c=n.productIds,o=new WebSocket("wss://www.cryptofacilities.com/ws/v1");return o.addEventListener("open",(function(){e=!1;var n=JSON.stringify(E(c));o.send(n)})),o.addEventListener("error",(function(n){r(n),o.close()})),o.addEventListener("message",(function(n){var r=function(n){try{return JSON.parse(n.data)}catch(e){L(o,e)}}(n);r&&(function(n){return"object"===typeof n&&"subscribed"===n.event}(r)&&((e=M(r,c))||L(o,new Error("OrderBook handshake failed"))),e&&(b(r)||j(r))&&t(r))})),function(){o.close()}}var l,O,p,v,g,x,h,m,y,w,k,S,E=function(n){return{event:"subscribe",feed:u,product_ids:n}},L=function(n,e){var t=document.createEvent("CustomEvent");t.initCustomEvent("error",!1,!1,e),n.dispatchEvent(t)},M=function(n,e){var t=n.feed===u,r=n.product_ids.every((function(n){return e.includes(n)}));return t&&r},I=t(15),A=t(5),F=t(38),_=t(39),T=t(22),C=t.n(T),z=function(n,e){var t=C()(n,e,(function(n){return Object(A.a)(n,1)[0]}));return n.splice(t,0,e),n},B=function(n,e){return n.splice(e,1),n},D=function(n,e){var t=Object(A.a)(e,2),r=t[0],c=t[1],o=n.findIndex((function(n){return Object(A.a)(n,1)[0]===r})),i=-1===o,a=c>0;if(i&&!a)return n;var s=Object(I.a)(n);return i?z(s,e):a?(s[o]=e,s):B(s,o)},H=function(n){var e=Object(r.useState)(!0),t=Object(A.a)(e,2),c=t[0],o=t[1],i=Object(r.useRef)([]),a=Object(r.useRef)([]),s=Object(r.useState)(),u=Object(A.a)(s,2),d=u[0],l=u[1],O=Object(F.a)();return Object(_.a)(O),Object(r.useEffect)((function(){return f({onData:function(n){b(n)&&(o(!1),i.current=n.asks,a.current=n.bids),j(n)&&(i.current=n.asks.reduce((function(n,e){return D(n,e)}),i.current),a.current=n.bids.reduce((function(n,e){return D(n,e)}),a.current))},onError:l,productIds:[n]})}),[n]),{asks:i.current,bids:Object(I.a)(a.current).reverse(),error:d,isLoading:c}},J=t(23),P=Object(J.a)({},d,"XBT/USD"),N=function(n){return P[n]},R=s.a.div(l||(l=Object(a.a)(["\n  display: flex;\n  flex-direction: column;\n  font-family: var(--font-mono);\n  font-size: var(--card-font-size);\n  background: var(--card-bg);\n  color: var(--card-color);\n  padding: 16px 0;\n"]))),U=s.a.div(O||(O=Object(a.a)(["\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  grid-auto-rows: 20px;\n  column-gap: var(--grid-column-gap);\n  row-gap: 4px;\n  text-align: right;\n"]))),W=function(n,e){if(!e)return 0;var t=Object(A.a)(e,1)[0],r=n.findIndex((function(n){return n[0]===t}));return-1===r?0:n.slice(0,r+1).reduce((function(n,e){return n+Object(A.a)(e,2)[1]}),0)},X=t(10),q=s.a.div(p||(p=Object(a.a)(["\n  padding: 4px 8px;\n  min-width: 90px;\n"]))),G=Object(s.a)(q)(v||(v=Object(a.a)(["\n  position: relative;\n\n  &:hover {\n    font-weight: bold;\n  }\n\n  &:nth-of-type(3n + 1) {\n    --row-full-width: calc(300% + var(--grid-column-gap) * 2);\n\n    color: var(--text-color);\n\n    ","\n\n    ","\n  }\n"])),(function(n){if(n.isHovered)return Object(X.a)(g||(g=Object(a.a)(["\n          &:after {\n            content: ' ';\n            position: absolute;\n            left: 0;\n            top: 0;\n            height: 100%;\n            width: var(--row-full-width);\n            background: rgba(255, 255, 255, 0.1);\n          }\n        "])))}),(function(n){var e=n.percentOfTotal;if("number"===typeof e)return Object(X.a)(x||(x=Object(a.a)(["\n          &:before {\n            content: ' ';\n            position: absolute;\n            left: 0;\n            top: 0;\n            height: 100%;\n            width: calc(var(--row-full-width) * ",");\n            background: var(--row-background);\n          }\n        "])),e)})),K=t(1),Q=function(n){var e=n.isHovered,t=n.onMouseOut,r=n.onMouseOver,c=n.price,o=n.size,i=n.total,a=n.totalSum;return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(G,{isHovered:e,onMouseOut:t,onMouseOver:r,percentOfTotal:(i-o)/a,children:c.toLocaleString()}),Object(K.jsx)(G,{onMouseOut:t,onMouseOver:r,children:o.toLocaleString()}),Object(K.jsx)(G,{onMouseOut:t,onMouseOver:r,children:i.toLocaleString()})]})},V=function(n){var e=n.orders,t=Object(r.useState)(-1),c=Object(A.a)(t,2),o=c[0],i=c[1];return Object(K.jsx)(K.Fragment,{children:e.map((function(n,t){var r=Object(A.a)(n,2),c=r[0],a=r[1];return Object(K.jsx)(Q,{isHovered:o===t,onMouseOut:function(){return i(-1)},onMouseOver:function(){return i(t)},price:c,size:a,total:W(e,[c,a]),totalSum:W(e,e[e.length-1])},c)}))})},Y=s.a.span(h||(h=Object(a.a)(["\n  color: var(--card-title-color);\n  text-transform: uppercase;\n  border-bottom: 1px dotted;\n"]))),Z=function(){return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(q,{children:Object(K.jsx)(Y,{children:"Price"})}),Object(K.jsx)(q,{children:Object(K.jsx)(Y,{children:"Size"})}),Object(K.jsx)(q,{children:Object(K.jsx)(Y,{children:"Total"})})]})},$=s.a.h2(m||(m=Object(a.a)(["\n  text-align: center;\n  margin: 0 0 16px;\n"]))),nn=Object(s.a)(U)(y||(y=Object(a.a)(["\n  --grid-column-gap: 8px;\n"]))),en=Object(s.a)(nn)(w||(w=Object(a.a)(["\n  margin-bottom: 16px;\n  --text-color: var(--asks-color);\n  --row-background: var(--asks-bg);\n"]))),tn=Object(s.a)(nn)(k||(k=Object(a.a)(["\n  --text-color: var(--bids-color);\n  --row-background: var(--bids-bg);\n"]))),rn=function(n){var e=n.ordersCount,t=void 0===e?10:e,c=n.productId,o=H(c),i=o.asks,a=o.bids,s=o.error,u=o.isLoading;return Object(r.useEffect)((function(){s&&console.error(s)}),[s]),Object(K.jsxs)(R,{children:[Object(K.jsxs)($,{children:["Orderbook (",N(c),")"]}),u&&"Loading...",!u&&Object(K.jsxs)(K.Fragment,{children:[Object(K.jsxs)(en,{children:[Object(K.jsx)(Z,{}),Object(K.jsx)(V,{orders:i.slice(0,t)})]}),Object(K.jsx)(tn,{children:Object(K.jsx)(V,{orders:a.slice(-t)})})]})]})},cn=s.a.div(S||(S=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 16px 0;\n"]))),on=function(){return Object(K.jsx)(cn,{children:Object(K.jsx)(rn,{productId:d})})},an=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,40)).then((function(e){var t=e.getCLS,r=e.getFID,c=e.getFCP,o=e.getLCP,i=e.getTTFB;t(n),r(n),c(n),o(n),i(n)}))};i.a.render(Object(K.jsx)(c.a.StrictMode,{children:Object(K.jsx)(on,{})}),document.getElementById("root")),an()}},[[36,1,2]]]);
//# sourceMappingURL=main.0ae93589.chunk.js.map